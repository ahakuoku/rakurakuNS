# らくらくNSとは？
SimutransのNSを管理するツールです。
- サーバーがクラッシュした場合に自動で再起動、それに付帯して必要な動作もすべて自動で行います。(一部要nettool)
- 一定の間隔でオートセーブを行います。(要nettool)オートセーブしたファイルはautosaveフォルダに100個まで保存されます。

といった機能があります。

# 導入方法
1. らくらくNSをDLする  
1. zipを解凍し、サーバーの実行ファイルが入っている所と同じディレクトリにbatとmoduleフォルダを入れる
# ダウンロード
ダウンロードはこちらから行えます。**(2020年11月15日　v1.1.0に更新)**  
https://github.com/ahakuoku/rakurakuNS/releases  
1.0.1以前のバージョンはこちら  
https://drive.google.com/drive/folders/1evLJx78f47vGNYuJIuvNgkNfmpygWu_A

# 使用条件
著作権は作者であるahakuokuが保有しています。  
改造・再配布(未改造・改造問わず)は自由にしていただいても結構です。(報告は任意)  
ただし、再配布をする場合はどこかに必ず原作者であるahakuokuの名を入れてください。  
改造はノンサポート、自己責任です。改造したことによる損害は一切責任を負いません。 このbatの営利目的での使用はご遠慮ください。

# 内容
autoclose.bat … 自動でセーブしたうえでサーバーを終了します。  
autosave.bat  … 一定の間隔で自動でセーブします。  
autostart.bat … サーバーがクラッシュした場合などに自動で再起動などをします。  
setting.bat   … 設定ファイルです。使用する前にここを弄ってください。

# 使用方法

## setting.bat
各種動作を設定するファイルです。使用する前にこちらを弄ってください。具体的な使用方法は下にあります。
- usingnettool	 … nettoolを使用するかどうかを設定します。0の場合は使用しません。
- nettoolpass	 … nettoolのパスワードを設定します。usingnettoolが0の場合は使用しません。
- startfile	 … サーバーがクラッシュした際に起動するファイルを設定します。-server オプションをつけたショートカットを起動するなどに使用できます。
- serversave	 … サーバーが読み込むセーブデーターを指定します。
- autosave	 … サーバーを×ボタンで終了した場合に生成されるセーブデーターを指定します。
- exename		 … サーバーのファイル名を指定します。サーバーが動いているかのチェックに使用します。
- serverip	 … サーバーのIPアドレスを指定します。
- 0companypass	 … デフォルト会社のパスワードを指定します。usingnettoolが0の場合は使用しません。
- autosaveinterval … オートセーブの間隔を秒で指定します。usingnettoolが0の場合は使用しません。60未満にはできません。
- pressspacekey	 … 自動再起動の後にスペースキーを自動で押すかどうかを指定します。pak重複警告の回避に使用できます。1の場合に有効になります。
- ban-ip1		 … BANするIPアドレスを指定します。
- ban-ip2		 … 同上
- ban-ip3		 … 同上
- ban-ip4		 … 同上
- ban-ip5		 … 同上

## autostart.bat
サーバーがクラッシュした場合に、自動再起動などの必要な動作を自動で行います。  
具体的には、pak重複警告を回避するためのスペースキー自動押下、自動での操作禁止会社へのパスワード設定、クラッシュによりリセットされたBANリストの再設定を行います。(デフォルトではいずれも無効です)

## autosave.bat
一定の間隔でオートセーブを行います。オートセーブ30秒前に予告メッセージを流します。オートセーブ前のデーターは100までautosaveフォルダにバックアップされます。動作にはnettoolが必要です。

## autoclose.bat
自動的にサーバーを安全な状態で停止します。サーバー停止の前にautostart.batを終了させてください。動作にはnettoolが必要です。

## serverupdate.bat
サーバーの本体をアップデートします。古い本体はserver_old.exeとしてバックアップされます。

# 謝辞
- module/worktime.batはhttps://qiita.com/koryuohproject/items/815a1621bc34a223e4b9 のものを使用させていただきました。

ありがとうございます。

# 更新履歴
- 現在の最新バージョンは、version 1.2.0です。

## version 1.2.0(2020/11/19)
- 本体自動置き換え機能を追加しました。serverupdate.batを起動して画面の指示に従ってください。古い本体はserver_old.exeとしてバックアップされます。

## version 1.1.0(2020/11/15)
- オートセーブをするたびにオートセーブの時刻がずれていく現象の軽減をしました。
- module/worktime.batはhttps://qiita.com/koryuohproject/items/815a1621bc34a223e4b9 のコードを引用しました。

## version 1.0.1(2020/11/13)
- autosaveフォルダにコピーするファイルが誤っていた問題を修正しました。

## version 1.0.0(2020/10/16)
- 初の正式版です。